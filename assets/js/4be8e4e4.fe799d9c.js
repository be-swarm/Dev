"use strict";(self.webpackChunkdev=self.webpackChunkdev||[]).push([[5851],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>f});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=r.createContext({}),l=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=l(e.components);return r.createElement(p.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,s=e.originalType,p=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=l(t),f=a,v=d["".concat(p,".").concat(f)]||d[f]||u[f]||s;return t?r.createElement(v,o(o({ref:n},c),{},{components:t})):r.createElement(v,o({ref:n},c))}));function f(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var s=t.length,o=new Array(s);o[0]=d;var i={};for(var p in n)hasOwnProperty.call(n,p)&&(i[p]=n[p]);i.originalType=e,i.mdxType="string"==typeof e?e:a,o[1]=i;for(var l=2;l<s;l++)o[l]=t[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},6151:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>o,default:()=>u,frontMatter:()=>s,metadata:()=>i,toc:()=>l});var r=t(7462),a=(t(7294),t(3905));const s={sidebar_position:4,title:"Bonnes pratiques"},o=void 0,i={unversionedId:"DevApps/NET/PACKAGES/CoreBlazorApp/WebApi/Bonnespatiques",id:"DevApps/NET/PACKAGES/CoreBlazorApp/WebApi/Bonnespatiques",title:"Bonnes pratiques",description:"Les classes d'acc\xe8s aux webapi sont g\xe9n\xe9r\xe9es \xe0 partir des sp\xe9cifications OpenApi.",source:"@site/docs/DevApps/NET/PACKAGES/CoreBlazorApp/WebApi/Bonnespatiques.md",sourceDirName:"DevApps/NET/PACKAGES/CoreBlazorApp/WebApi",slug:"/DevApps/NET/PACKAGES/CoreBlazorApp/WebApi/Bonnespatiques",permalink:"/Dev/docs/DevApps/NET/PACKAGES/CoreBlazorApp/WebApi/Bonnespatiques",draft:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,title:"Bonnes pratiques"},sidebar:"tutorialSidebar",previous:{title:"Client Http",permalink:"/Dev/docs/DevApps/NET/PACKAGES/CoreBlazorApp/WebApi/ClientHttp"}},p={},l=[{value:"Validation des donn\xe9es",id:"validation-des-donn\xe9es",level:2},{value:"Gestion des erreurs",id:"gestion-des-erreurs",level:2}],c={toc:l};function u(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,r.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Les classes d'acc\xe8s aux webapi sont g\xe9n\xe9r\xe9es \xe0 partir des sp\xe9cifications OpenApi.\nLes objets \xe0 passer aux webapi sont g\xe9n\xe9r\xe9s avec les annotations de validation de donn\xe9es.\nLes status sont aussi g\xe9n\xe9r\xe9s en fonction des status retourn\xe9s par les webapi."),(0,a.kt)("p",null,"Le d\xe9veloppeur a donc toutes les informations disponibles afin de s'affanchir de toute cette gestion\nfastidieuses."),(0,a.kt)("h2",{id:"validation-des-donn\xe9es"},"Validation des donn\xe9es"),(0,a.kt)("p",null,"Il est important de s'assurer que les objets envoy\xe9s aux webapi sont valides.\nDans tous les cas un appel d'api avec des donn\xe9es invalides retournera un status 400."),(0,a.kt)("h2",{id:"gestion-des-erreurs"},"Gestion des erreurs"),(0,a.kt)("p",null,"Une exception est g\xe9n\xe9r\xe9e pour tout status diff\xe9rent de 200.\nIl convient donc de s'assurer que les appels aux webapi sont dans un bloc try/catch.\nLe bloc catch peut-\xeatre exploit\xe9 afin de d\xe9terminer la gravit\xe9 de l'erreur.\nEx: Une webapi qui retourne rien va retourner un status 404 qui va ainsi g\xe9n\xe9r\xe9 une exception.\nCe n'est pas pour autant une erreur grave."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csharp"},'\nvar httpclient = Session.GetUserHttpClient();\nBeSwarm.WebApi.Planner.Planner plan = new("", httpclient);\n\nBeSwarm.WebApi.Planner.CreatePlanner create = new();\ncreate.Description = "....";\ntry\n{\n    var result = await plan.AddPlannerAsync(Session.UserToken, create);\n}\ncatch (Exception e)\n{\n}\n\n')),(0,a.kt)("admonition",{title:"Information",type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Les exceptions retourn\xe9es par les classes g\xe9n\xe9r\xe9es sont relativement complexes \xe0 exploiter.\nPour cela BeSwarmEnvironment propose une fonction qui permet de normaliser les erreurs avec\nun seul et unique format.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csharp"},'\nvar httpclient = Session.GetUserHttpClient();\nBeSwarm.WebApi.Planner.Planner plan = new("", httpclient);\n\nBeSwarm.WebApi.Planner.CreatePlanner create = new();\ncreate.Description = "....";\ntry\n{\n    var result = await plan.AddPlannerAsync(Session.UserToken, create);\n}\ncatch (Exception e)\n{\n   // highlight-start\n   ResultAction err=Session.GetInternalErrorFromException(e)\n   if (err.Error == StatusAction.Notfound)\n   {\n   }\n   // highlight-end\n}\n\n')),(0,a.kt)("p",null,"D\xe8s lors il est facile de d\xe9nir les actions \xe0 effectuer en fonction de l'erreur."),(0,a.kt)("p",null,"ResultAction dispose d'une variable IsError qui si elle est \xe0 vrai indique que l'erreur est grave.\nIl est donc possible de d\xe9finir des actions \xe0 effectuer en fonction de cette variable.\nex:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csharp"},"catch (Exception e)\n{\n   ResultAction err=Session.GetInternalErrorFromException(e)\n   // highlight-start\n   if (err.IsError)\n   {\n     // probl\xe8me\n   }\n   // highlight-end\n}\n")))}u.isMDXComponent=!0}}]);